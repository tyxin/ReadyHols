{% extends "/login/collapse-bar.html" %}
{% block title %}Ready!Hols{% endblock %}
{% block head %} {{ super() }} {% endblock %}

{% block content %}
<script src="/static/javascript/popup.js" defer></script>
<script src="/static/javascript/table_select.js" defer></script>

<style>
    .top-container{ margin: 5% 2% 5% 2%; }
    .bottom-container{margin-top: 2%;}
    .col{padding-top: 1%}

    .image { position: relative; width: 100%; }
         
    html, body {
    max-width: 100%;
    overflow-x: hidden;
    }

    .vacation-card{
        margin-right:0%;
        margin-top: 0%;
        background-color:#c8cef3;
        padding: 20px;
        border-radius: 5px;
    }

    a{
        color:#242526;
    }

    a:hover{
        color:#3A3B3C;
    } 

    .selected{
        background-color:#c8cef3;
        font-weight: bold;
    }
    

</style>
<body>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

    <div class="top-container align-items-start">
        <h2>{% if session['username']%} Welcome Back, {{session['username']}}! {% endif %}</h2>
        <h4>Upcoming Vacations</h4>
        <div class="row">
            {%for i in recent_vacations_user%}
                <div class="col" style="max-width: 25%;">
                    <div class="vacation-card" style="height: 100%; max-width: 100%;">
                        <div class="card-body">
                            <h5 class="card-title">{{i['description']}}</h5>
                            <span class="d-inline-block text-truncate" style="max-width: 100%;">
                                <Lorem class="card-text">
                                    Start Date: {{i['start_date']}}<br>
                                    End Date: {{i['end_date']}}<br>
                                <a href="{{url_for('logged_vacations_template',vac_id=i['vac_id'],page='summary')}}">
                                    Explore
                                    <i class="bi bi-arrow-right"></i>
                                </a>
                                </Lorem>
                            </span>
                        </div>
                    </div>
                </div>
            {% endfor %}

            <div class="bottom-container justify-content-center">
                <h4>All my vacations</h4>
                <span>
                    <button class="btn btn-outline-secondary" href="#" onclick="show('vacationPopUp')">Add Vacation</button>
                    <button class="btn btn-outline-secondary" href="#" onclick="update_row('vacation_tbl','{{vacation_user}}','add_vacation_description')">Update Vacation</button>
                    <button class="btn btn-outline-secondary" href="#">Delete Vacation</button>
                </span>
                <div class="popup" id="vacationPopUp">
                    <form method="POST" action="{{url_for('add_update_vacation',type_of_update='UPDATE')}}" role="search" style="padding:2%; overflow:auto; height: 100%; overflow-x:hidden;">

                        <h3>New Vacation</h3>
                        <br>
                        <input style="margin-top: 1%;" class="form-control me-2" name="add_vacation_description" id="add_vacation_description" placeholder="Description" aria-label="Description">

                        <input style="margin-top: 1%;" class="form-control me-2" name="add_vacation_grp" id="add_vacation_grp" placeholder="Vacation Group ID" aria-label="Vacation Group ID">

                        <input style="margin-top: 1%;" class="form-control me-2" name="add_vacation_grp_pin" id="add_vacation_grp_pin" placeholder="Vacation Group PIN" aria-label="Vacation Group PIN">

                        <input type="date" style="margin-top: 1%;" class="form-control me-2" name="add_vacation_start_date" id="add_vacation_start_date" placeholder="Vacation Start Date" aria-label="Vacation Start Date" type="date">

                        <input type="date" style="margin-top: 1%;" class="form-control me-2" name="add_vacation_end_date" id="add_vacation_end_date" placeholder="Vacation End Date" aria-label="Vacation End Date" type="date">

                        <input style="margin-top: 1%;" class="form-control me-2" name="add_vacation_budget_limit" id="add_vacation_budget_limit" placeholder="Vacation Budget Limit" aria-label="Vacation Budget Limit" type="number">

                        <div class="form-check" style="margin-top: 1%; margin-bottom: 1%;">
                          <input class="form-check-input" type="checkbox" name="vacationUpgrade" id="vacationUpgradeCheck">
                          <label class="form-check-label" for="vacationUpgradeCheck">
                            Upgrade Vacation
                          </label>
                        </div>

                        {% with errors = get_flashed_messages(category_filter=["error"]) %}
                            {% if errors %}
                            <div class="alert alert-danger" role="alert">
                                {% for message in errors %}
                                {{ message }}
                                {% endfor %}
                            </div>
                            {% endif %}
                            {% endwith %}

                        <span>
                            <button class="btn btn-outline-secondary" type="submit">Add</button>
                            <button class="btn btn-outline-secondary" type="button" onclick="hide('vacationPopUp')">Cancel</button>
                        </span>

                    </form>
                </div>
                <br>
                <form method="POST" class="row" action="{{url_for('logged_vacations')}}" role="search" style="margin-top:1%; margin-bottom: 1%;">
                  <div class="col-6 col-md-8">
                      <input class="form-control me-2" name="search" type="search" placeholder="Search by pressing enter" aria-label="Search">
                  </div>
                  <div class="col-6 col-md-4">
                      <select class="form-select" name="category">
                        {% for i in fields%}
                          <option value="{{i}}">Search by {{i}}</option>
                        {% endfor %}
                      </select>
                  </div>
                </form>
                <p></p>
                <!-- to figure out and continue from here -->
                <table class="table table-hover" aria-selected="true" aria-multiselectable="false" id="vacation_tbl">
                    <thead class="bg-dark text-white">
                      <tr style="pointer-events: none;">
                        <th scope="col">No.</th>
                        <th scope="col">Vacation Description</th>
                        <th scope="col">Start Date</th>
                        <th scope="col">End Date</th>
                        <th scope="col">Budget Limit</th>
                      </tr>
                    </thead>
                    <tbody>
                    {% for j in vacations_user%}
                      <tr>
                        <th scope="row">{{loop.index}}</th>
                        <td><a href="{{url_for('logged_vacations_template',vac_id=j['vac_id'],page='summary')}}">{{j['description']}}</a></td>
                        <td>{{j['start_date']}}</td>
                        <td>{{j['end_date']}}</td>
                        <td>${{j['budget_limit']}}</td>
                      </tr>
                    {% endfor %}

                    </tbody>
                  </table>
              </div>

        </div>
    </div>

    
      
</body>

{% endblock %}

